{
    "collab_server" : "",
    "contents" : "# Rafael de Souza, UNC\n#This program is free software: you can redistribute it and/or modify\n#it under the terms of the GNU General Public License version 3 as published by\n#the Free Software Foundation.\n\n#This program is distributed in the hope that it will be useful,\n#but WITHOUT ANY WARRANTY; without even the implied warranty of\n#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n#GNU General Public License for more details.\n\n#  A copy of the GNU General Public License is available at\n#  http://www.r-project.org/Licenses/\n#\n#' @title  Estimate Astrophysical S-factor\n#' @description Provides a confusion matrix of classification statistics following logistic regression.\n#' @aliases sfactorTdn\n#' @usage sfactorTdn(ECM = ECM, ER = ER, gi = gi, gf = gf)\n#' @format \\describe{\n#' \\item{x}{\n#' The function has four arguments: ECM, ER, gi, gf}\n#' }\n#' @param ECM ECM\n#' @param ER  ER\n#' @param gi  gi\n#' @param gf  gf\n#' @return S-factor\n#' @import gsl\n#' @examples\n#' library(nuclear)\n#'\n#' N <- 300\n#' obsx1 <- exp(seq(log(1e-3), log(1),length.out=N))\n#' plot(obsx1,sfactorTdn(obsx1,0.0912,2.93,0.0794),ylim=c(0,32.5),\n#'      xlim=c(1e-3,1),col=\"red\",cex=1.25,type=\"l\",ylab=\"S-factor\",xlab=\"E\",log=\"x\")\n#'\n#' @author Rafael de Souza, UNC,  and Christian Illiadis, UNC\n#'\n#' @keywords S-factor\n#' @export\n#'\n#'\nsfactorTdn <- function(ECM,ER,gi,gf){\n\n# Constants\nm1_i = 3.016; m2_i = 2.014;\t\t# masses (amu) of t and d\nm1_f = 4.0026; m2_f = 1.0087;\t# masses (amu) of n and 4He\nz1_i = 1; z2_i = 1;\t\t\t# charges of t and d\nz1_f = 2; z2_f = 0;\t\t\t\t#charges of n and 4He\nr_i = 6.0; r_f = 5.0;\t\t\t# channel radii (fm)\njt = 0.5; jp = 1.0; jr = 1.5;\t\t\t#spins of target, projectile, resonance\nQ = 17.589;\t\t\t\t\t\t#reaction Q-value (MeV)\nla = 0; lb = 2;\t\t\t\t\t#orbital angular momenta of d and n\n\n#   DEFINITIONS\n\nmue_i <- (m1_i*m2_i)/(m1_i + m2_i);\nmue_f <- (m1_f*m2_f)/(m1_f + m2_f);\npek <- 6.56618216e-1/mue_i;\nomega <- (2*jr + 1)/((2*jt + 1)*(2*jp + 1));\n\n#     ----------------------------------------------------\n#     PENETRABILITY AND SHIFT FUNCTION AT ER\n#     ----------------------------------------------------\n\n\n  eta_a = 0.15748927*z2_i*z1_i*sqrt(mue_i)\n  rho_a = 0.218735097*r_i*sqrt(mue_i)\n  reta_i = eta_a/(sqrt(ER))\n  rrho_i = rho_a*(sqrt(ER))\n\n  P1 <- coulomb_wave_FG(reta_i, rrho_i, la, k = 0)\n  pr_i <- rrho_i/(P1$val_F^2 + P1$val_G^2)\n  sr_i <- rrho_i*(P1$val_F*P1$val_Fp + P1$val_G*P1$val_Gp)/(P1$val_F^2 + P1$val_G^2)\n  ga <- 2*gi*pr_i\n\n\n  eta_b = 0.15748927*z2_f*z1_f*sqrt(mue_f)\n  rho_b = 0.218735097*r_f*sqrt(mue_f)\n  reta_f = eta_b/(sqrt(ER + Q))\n  rrho_f = rho_b*(sqrt(ER + Q))\n\n  P2 <- coulomb_wave_FG(reta_f, rrho_f, lb, k = 0)\n  pr_f <- rrho_f/(P2$val_F^2 + P2$val_G^2)\n  sr_f <- rrho_f*(P2$val_F*P2$val_Fp + P2$val_G*P2$val_Gp)/(P2$val_F^2 + P2$val_G^2)\n  gb <- 2*gf*pr_f\n\n# CALCULATE S-FACTOR\n\n  etpe_i = exp(0.989534267*z1_i*z2_i*sqrt(mue_i/ECM))\n  eta_i = eta_a/(sqrt(ECM))\n  rho_i = rho_a*(sqrt(ECM))\n  P3 <- coulomb_wave_FG(eta_i, rho_i, la, k = 0)\n  p_i <- rho_i/(P3$val_F^2 + P3$val_G^2)\n  s_i <- rho_i*(P3$val_F*P3$val_Fp + P3$val_G*P3$val_Gp)/(P3$val_F^2 + P3$val_G^2)\n  prat_i = p_i/pr_i\n\n  eta_f = eta_b/(sqrt(ECM + Q))\n  rho_f = rho_b*(sqrt(ECM + Q))\n  P4 <- coulomb_wave_FG(eta_f, rho_f, lb, k = 0)\n  p_f <- rho_f/(P4$val_F^2 + P4$val_G^2)\n  s_f <- rho_f*(P4$val_F*P4$val_Fp + P4$val_G*P4$val_Gp)/(P4$val_F^2 + P4$val_G^2)\n  prat_f = p_f/pr_f\n\n  tapp <- (s_i - sr_i)*gi + (s_f - sr_f)*gf\n\n  s1 = pek*etpe_i*omega*prat_i*prat_f*ga*gb\n  s2 = ((ER - ECM - tapp)^2) + 0.25*((ga*prat_i + gb*prat_f)^2)\n  SF <- s1/s2\n  return(SF = SF)\n}\n\n",
    "created" : 1506388708513.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3832010781",
    "id" : "BA8D8889",
    "lastKnownWriteTime" : 1506390252,
    "last_content_update" : 1506390252273,
    "path" : "~/Documents/GitHub/nuclear_package/nuclear/R/sfactorTdn.R",
    "project_path" : "R/sfactorTdn.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}